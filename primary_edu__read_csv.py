# !/usr/bin/env python# -*- coding: utf-8 -*-import osimport djangoimport sysimport geocoderos.environ.setdefault("DJANGO_SETTINGS_MODULE", "project_liveability.settings")django.setup()import loggingfrom liveability.models import Scores, TwoDishesOneSoupIdx, PriSchoolRankfrom openpyxl import load_workbooklog = logging.getLogger(__name__)if __name__ == "__main__":    wb2 = load_workbook('/home/ubuntu/project_liveability/data/Education Data.xlsx')    sheet = wb2.active    a1 = sheet['A1']    a2 = sheet['A2']    a3 = sheet.cell(row=1, column=1)    # print(a1.value)    # print(a2.value)    # print(a3.value)    # x_count = 2    # y_count = 1    # if x_count < 455:    for x_count in range(2, 455):        # if y_count < 12:        name_of_school = ''        academic = ''        sport = ''        music = ''        teaching_resource = ''        dormitory = ''        ranking_score_this_year = ''        ranking_score_average = ''        district_chn = ''        xiao_wang = ''        for y_count in range(2, 11):            if x_count == 0 or y_count == 0 or y_count == 1:                pass            else:                r = sheet.cell(row=x_count, column=y_count)                print(r.value)                if y_count == 2:                    # new_rec = EducationData(                    name_of_school = r.value                    # )                elif y_count == 3:                    # new_rec = EducationData(                    academic = r.value                    # )                elif y_count == 4:                    # new_rec = EducationData(                    sport = r.value                    # )                elif y_count == 5:                    # new_rec = EducationData(                    music = r.value                    # )                elif y_count == 6:                    # new_rec = EducationData(                    teaching_resource = r.value                    # )                elif y_count == 7:                    # new_rec = EducationData(                    dormitory = r.value                    # )                elif y_count == 8:                    # new_rec = EducationData(                    ranking_score_this_year = r.value                    # )                elif y_count == 9:                    # new_rec = EducationData(                    ranking_score_average = r.value                    # )                elif y_count == 10:                    # new_rec = EducationData(                    district_chn = r.value                    # )                elif y_count == 11:                    # new_rec = EducationData(                    xiao_wang = r.value                    # )        g = geocoder.google(name_of_school)        # print(g)        try:            lat = g.latlng[0]            lng = g.latlng[1]        except IndexError:            if "<[OVER_QUERY_LIMIT] Google - Geocode>" == str(g):                print("--> # 2 # <-------------------")                print("<[OVER_QUERY_LIMIT] Google - Geocode>")                # my_emailing = emailing.GeneralEmail()                # my_emailing.email_for_time_report(" <[OVER_QUERY_LIMIT] "                #                                   "Google - Geocode> ")                print("END.")                print("")                break            else:                print("-------Error Msg--------------")                print("====> # 2 #<===== ")            break        district_eng = ''        if district_chn == u"中西":            district_chn = u'中西區'            district_eng = 'Central & Western'        elif district_chn == u'灣仔':            district_chn = u'灣仔'            district_eng = 'Wan Chai'        elif district_chn == u'東區':            district_chn = u'東區'            district_eng = 'Eastern'        elif district_chn == u'南區':            district_chn = '南區'            district_eng = 'Southern'        elif district_chn == u'油尖旺':            district_chn = u'油尖旺'            district_eng = 'Yau Tsim Mong'        elif district_chn == u'九龍城':            district_chn = u'九龍城'            district_eng = 'Kowloon City'        elif district_chn == u'深水埗':            district_chn = u'深水埗'            district_eng = 'Sham Shui Po'        elif district_chn == u'黃大仙':            district_chn = u'黃大仙'            district_eng = 'Wong Tai Sin'        elif district_chn == u'觀塘':            district_chn = u'觀塘'            district_eng = 'Kwun Tong'        elif district_chn == u'荃灣':            district_chn = u'荃灣'            district_eng = 'Tsuen Wan'        elif district_chn == u'葵涌':            district_chn = u'葵青'            district_eng = 'Kwai Tsing'        elif district_chn == u'屯門':            district_chn = u'屯門'            district_eng = 'Tuen Mun'        elif district_chn == u'元朗':            district_chn = u'元朗'            district_eng = 'Yuen Long'        elif district_chn == u'北區':            district_chn = u'北區'            district_eng = 'North'        elif district_chn == u'大埔':            district_chn = u'大埔'            district_eng = 'Tai Po'        elif district_chn == u'沙田':            district_chn = u'沙田'            district_eng = 'Sha Tin'        elif district_chn == u'西頁':            district_chn = u'西貢'            district_eng = 'Sai Kung'        elif district_chn == u'離島':            district_chn = u'離島'            district_eng = 'Island'        new_rec = PriSchoolRank(            name_of_school=name_of_school,            lat=lat,            lng=lng,            academic=academic,            sport=sport,            music=music,            teaching_resource=teaching_resource,            dormitory=dormitory,            ranking_score_this_year=ranking_score_this_year,            ranking_score_average=ranking_score_average,            district_chn=district_chn,            district_eng=district_eng,        )        new_rec.save()        print("---------------------->")