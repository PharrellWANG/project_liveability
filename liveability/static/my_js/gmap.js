// /**// * Created by Pharrell_WANG on 30/3/2017.// */// var mapStyle = [{//     'stylers': [{'visibility': 'off'}]// }, {//     'featureType': 'landscape',//     'elementType': 'geometry',//     'stylers': [{'visibility': 'on'}, {'color': '#fcfcfc'}]// }, {//     'featureType': 'water',//     'elementType': 'geometry',//     'stylers': [{'visibility': 'on'}, {'color': '#bfd4ff'}]// }];// var map;// var censusMin = Number.MAX_VALUE, censusMax = -Number.MAX_VALUE;//// function initMap() {////     // load the map//     map = new google.maps.Map(document.getElementById('map'), {//         center: {lat: 22.326394, lng: 114.149139},//         zoom: 11,//         styles: mapStyle,//         scrollwheel: false//     });////     // Add a style-selector control to the map.//     var styleControl = document.getElementById('style-selector-control');//     map.controls[google.maps.ControlPosition.TOP_LEFT].push(styleControl);////     // Set the map's style to the initial value of the selector.//     var styleSelector = document.getElementById('style-selector');////     map.setOptions({styles: styles[styleSelector.value]});//////     // Apply new JSON when the user selects a different style.//     styleSelector.addEventListener('change', function () {//         map.setOptions({styles: styles[styleSelector.value]});//     });//////     // set up the style rules and events for google.maps.Data//     map.data.setStyle(styleFeature);//     map.data.addListener('mouseover', mouseInToRegion);//     map.data.addListener('mouseout', mouseOutOfRegion);//     // wire up the button//     var selectBox = document.getElementById('census-variable');//     google.maps.event.addDomListener(selectBox, 'change', function () {//         clearCensusData();//         loadCensusData(selectBox.options[selectBox.selectedIndex].value);//     });////     // state polygons only need to be loaded once, do them now//     loadMapShapes();//// }//// /** Loads the state boundary polygons from a GeoJSON source. */// function loadMapShapes() {//     // load US state outline polygons from a GeoJson file//     map.data.loadGeoJson("{% static '' %}geojson/hk.json", {idPropertyName: 'ID_1'});//     // wait for the request to complete by listening for the first feature to be//     // added//     google.maps.event.addListenerOnce(map.data, 'addfeature', function () {//         google.maps.event.trigger(document.getElementById('census-variable'),//             'change');//     });// }//// /**//  * Loads the census data from a simulated API call to the US Census API.//  *//  * @param {string} variable//  */// function loadCensusData(variable) {//     // load the requested variable from the census API (using local copies)//     var xhr = new XMLHttpRequest();//     if (variable == "liangsongyitang") {//         xhr.open('GET', '{% static '' %}json_data/liangsongyitang.json');//     }//     else if (variable == "edu") {//         xhr.open('GET', '{% static '' %}json_data/edu.json');//     }//     else if (variable == "house") {//         xhr.open('GET', '{% static '' %}json_data/house.json');//     }//     else if (variable == "cr") {//         xhr.open('GET', '{% static '' %}json_data/cr.json');//     }////     xhr.onload = function () {//         var censusData = JSON.parse(xhr.responseText);//         censusData.shift(); // the first row contains column names//         censusData.forEach(function (row) {//             var censusVariable = parseFloat(row[0]);//             var stateId = row[1];//             console.log(censusVariable)////             // keep track of min and max values//             if (censusVariable < censusMin) {//                 censusMin = censusVariable;//             }//             if (censusVariable > censusMax) {//                 censusMax = censusVariable;//             }////             // update the existing row with the new data//             map.data//                 .getFeatureById(stateId)//                 .setProperty('census_variable', censusVariable);//         });////         // update and display the legend//         document.getElementById('census-min').textContent =//             censusMin.toLocaleString();//         document.getElementById('census-max').textContent =//             censusMax.toLocaleString();//     };//     xhr.send();// }//// /** Removes census data from each shape on the map and resets the UI. */// function clearCensusData() {//     censusMin = Number.MAX_VALUE;//     censusMax = -Number.MAX_VALUE;//     map.data.forEach(function (row) {//         row.setProperty('census_variable', undefined);//     });//     document.getElementById('data-box').style.display = 'none';//     document.getElementById('data-caret').style.display = 'none';// }//// /**//  * Applies a gradient style based on the 'census_variable' column.//  * This is the callback passed to data.setStyle() and is called for each row in//  * the data set.  Check out the docs for Data.StylingFunction.//  *//  * @param {google.maps.Data.Feature} feature//  */// function styleFeature(feature) {//     var high = [5, 69, 54];  // color of smallest datum//     var low = [151, 83, 34];   // color of largest datum////     // delta represents where the value sits between the min and max//     var delta = (feature.getProperty('census_variable') - censusMin) ///         (censusMax - censusMin);////     var color = [];//     for (var i = 0; i < 3; i++) {//         // calculate an integer color based on the delta//         color[i] = (high[i] - low[i]) * delta + low[i];//     }////     // determine whether to show this shape or not//     var showRow = true;//     if (feature.getProperty('census_variable') == null ||//         isNaN(feature.getProperty('census_variable'))) {//         showRow = false;//     }////     var outlineWeight = 0.5, zIndex = 1;//     if (feature.getProperty('state') === 'hover') {//         outlineWeight = zIndex = 2;//     }////     return {//         strokeWeight: outlineWeight,//         strokeColor: '#fff',//         zIndex: zIndex,//         fillColor: 'hsl(' + color[0] + ',' + color[1] + '%,' + color[2] + '%)',//         fillOpacity: 0.75,//         visible: showRow//     };// }//// /**//  * Responds to the mouse-in event on a map shape (state).//  *//  * @param {?google.maps.MouseEvent} e//  */// function mouseInToRegion(e) {//     // set the hover state so the setStyle function can change the border -----//     e.feature.setProperty('state', 'hover');////     var percent = (e.feature.getProperty('census_variable') - censusMin) ///         (censusMax - censusMin) * 100;////     // update the label//     document.getElementById('data-label').textContent =//         e.feature.getProperty('name');//     document.getElementById('data-value').textContent =//         e.feature.getProperty('census_variable');//     document.getElementById('data-box').style.display = 'block';//     document.getElementById('data-caret').style.display = 'block';//     document.getElementById('data-caret').style.paddingLeft = percent + '%';// }//// /**//  * Responds to the mouse-out event on a map shape (state).//  *//  * @param {?google.maps.MouseEvent} e//  */// function mouseOutOfRegion(e) {//     // reset the hover state, returning the border to normal//     e.feature.setProperty('state', 'normal');// }//// var styles = {//     default: null,//     silver: [//         {//             elementType: 'geometry',//             stylers: [{color: '#f5f5f5'}]//         },//         {//             elementType: 'labels.icon',//             stylers: [{visibility: 'off'}]//         },//         {//             elementType: 'labels.text.fill',//             stylers: [{color: '#616161'}]//         },//         {//             elementType: 'labels.text.stroke',//             stylers: [{color: '#f5f5f5'}]//         },//         {//             featureType: 'administrative.land_parcel',//             elementType: 'labels.text.fill',//             stylers: [{color: '#bdbdbd'}]//         },//         {//             featureType: 'poi',//             elementType: 'geometry',//             stylers: [{color: '#eeeeee'}]//         },//         {//             featureType: 'poi',//             elementType: 'labels.text.fill',//             stylers: [{color: '#757575'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'geometry',//             stylers: [{color: '#e5e5e5'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'labels.text.fill',//             stylers: [{color: '#9e9e9e'}]//         },//         {//             featureType: 'road',//             elementType: 'geometry',//             stylers: [{color: '#ffffff'}]//         },//         {//             featureType: 'road.arterial',//             elementType: 'labels.text.fill',//             stylers: [{color: '#757575'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'geometry',//             stylers: [{color: '#dadada'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'labels.text.fill',//             stylers: [{color: '#616161'}]//         },//         {//             featureType: 'road.local',//             elementType: 'labels.text.fill',//             stylers: [{color: '#9e9e9e'}]//         },//         {//             featureType: 'transit.line',//             elementType: 'geometry',//             stylers: [{color: '#e5e5e5'}]//         },//         {//             featureType: 'transit.station',//             elementType: 'geometry',//             stylers: [{color: '#eeeeee'}]//         },//         {//             featureType: 'water',//             elementType: 'geometry',//             stylers: [{color: '#c9c9c9'}]//         },//         {//             featureType: 'water',//             elementType: 'labels.text.fill',//             stylers: [{color: '#9e9e9e'}]//         }//     ],//     night: [//         {elementType: 'geometry', stylers: [{color: '#242f3e'}]},//         {elementType: 'labels.text.stroke', stylers: [{color: '#242f3e'}]},//         {elementType: 'labels.text.fill', stylers: [{color: '#746855'}]},//         {//             featureType: 'administrative.locality',//             elementType: 'labels.text.fill',//             stylers: [{color: '#d59563'}]//         },//         {//             featureType: 'poi',//             elementType: 'labels.text.fill',//             stylers: [{color: '#d59563'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'geometry',//             stylers: [{color: '#263c3f'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'labels.text.fill',//             stylers: [{color: '#6b9a76'}]//         },//         {//             featureType: 'road',//             elementType: 'geometry',//             stylers: [{color: '#38414e'}]//         },//         {//             featureType: 'road',//             elementType: 'geometry.stroke',//             stylers: [{color: '#212a37'}]//         },//         {//             featureType: 'road',//             elementType: 'labels.text.fill',//             stylers: [{color: '#9ca5b3'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'geometry',//             stylers: [{color: '#746855'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'geometry.stroke',//             stylers: [{color: '#1f2835'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'labels.text.fill',//             stylers: [{color: '#f3d19c'}]//         },//         {//             featureType: 'transit',//             elementType: 'geometry',//             stylers: [{color: '#2f3948'}]//         },//         {//             featureType: 'transit.station',//             elementType: 'labels.text.fill',//             stylers: [{color: '#d59563'}]//         },//         {//             featureType: 'water',//             elementType: 'geometry',//             stylers: [{color: '#17263c'}]//         },//         {//             featureType: 'water',//             elementType: 'labels.text.fill',//             stylers: [{color: '#515c6d'}]//         },//         {//             featureType: 'water',//             elementType: 'labels.text.stroke',//             stylers: [{color: '#17263c'}]//         }//     ],//     retro: [//         {elementType: 'geometry', stylers: [{color: '#ebe3cd'}]},//         {elementType: 'labels.text.fill', stylers: [{color: '#523735'}]},//         {elementType: 'labels.text.stroke', stylers: [{color: '#f5f1e6'}]},//         {//             featureType: 'administrative',//             elementType: 'geometry.stroke',//             stylers: [{color: '#c9b2a6'}]//         },//         {//             featureType: 'administrative.land_parcel',//             elementType: 'geometry.stroke',//             stylers: [{color: '#dcd2be'}]//         },//         {//             featureType: 'administrative.land_parcel',//             elementType: 'labels.text.fill',//             stylers: [{color: '#ae9e90'}]//         },//         {//             featureType: 'landscape.natural',//             elementType: 'geometry',//             stylers: [{color: '#dfd2ae'}]//         },//         {//             featureType: 'poi',//             elementType: 'geometry',//             stylers: [{color: '#dfd2ae'}]//         },//         {//             featureType: 'poi',//             elementType: 'labels.text.fill',//             stylers: [{color: '#93817c'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'geometry.fill',//             stylers: [{color: '#a5b076'}]//         },//         {//             featureType: 'poi.park',//             elementType: 'labels.text.fill',//             stylers: [{color: '#447530'}]//         },//         {//             featureType: 'road',//             elementType: 'geometry',//             stylers: [{color: '#f5f1e6'}]//         },//         {//             featureType: 'road.arterial',//             elementType: 'geometry',//             stylers: [{color: '#fdfcf8'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'geometry',//             stylers: [{color: '#f8c967'}]//         },//         {//             featureType: 'road.highway',//             elementType: 'geometry.stroke',//             stylers: [{color: '#e9bc62'}]//         },//         {//             featureType: 'road.highway.controlled_access',//             elementType: 'geometry',//             stylers: [{color: '#e98d58'}]//         },//         {//             featureType: 'road.highway.controlled_access',//             elementType: 'geometry.stroke',//             stylers: [{color: '#db8555'}]//         },//         {//             featureType: 'road.local',//             elementType: 'labels.text.fill',//             stylers: [{color: '#806b63'}]//         },//         {//             featureType: 'transit.line',//             elementType: 'geometry',//             stylers: [{color: '#dfd2ae'}]//         },//         {//             featureType: 'transit.line',//             elementType: 'labels.text.fill',//             stylers: [{color: '#8f7d77'}]//         },//         {//             featureType: 'transit.line',//             elementType: 'labels.text.stroke',//             stylers: [{color: '#ebe3cd'}]//         },//         {//             featureType: 'transit.station',//             elementType: 'geometry',//             stylers: [{color: '#dfd2ae'}]//         },//         {//             featureType: 'water',//             elementType: 'geometry.fill',//             stylers: [{color: '#b9d3c2'}]//         },//         {//             featureType: 'water',//             elementType: 'labels.text.fill',//             stylers: [{color: '#92998d'}]//         }//     ],//     hiding: [//         {//             featureType: 'poi.business',//             stylers: [{visibility: 'off'}]//         },//         {//             featureType: 'transit',//             elementType: 'labels.icon',//             stylers: [{visibility: 'off'}]//         }//     ]// };//